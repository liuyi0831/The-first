<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cx.dao.UserOrderMapper">
<resultMap id="BaseResultMap" type="com.cx.pojo.UserOrder">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 23 17:29:01 CST 2018.
    -->
    <id column="order_id" jdbcType="VARCHAR" property="orderId" />
    <result column="price_id" jdbcType="VARCHAR" property="priceId" />
    <result column="user_id" jdbcType="VARCHAR" property="userId" />
    <result column="order_time" jdbcType="VARCHAR" property="orderTime" />
    <result column="adt_psgnum" jdbcType="INTEGER" property="adtPsgnum" />
    <result column="kid_psgnum" jdbcType="INTEGER" property="kidPsgnum" />
    <result column="amount" jdbcType="INTEGER" property="amount" />
    <result column="statement" jdbcType="VARCHAR" property="statement" />
    <result column="flight_ftime" jdbcType="VARCHAR" property="flightftime" />
    <result column="flight_name" jdbcType="VARCHAR" property="flightname" />
    <result column="flight_id" jdbcType="VARCHAR" property="flightid" />
  </resultMap>
<sql id="select_orders">
orders.order_id,amount,order_time,orders.statement,
</sql>
<sql id="select_flight">
flight.flight_ftime,flight_name, flight.flight_id
</sql>
<select id="getAll" parameterType="java.lang.String" resultMap="BaseResultMap">
		Select
		<include refid="select_orders" />
		<include refid="select_flight"></include>
		from orders, price,flight 
        where user_id=#{userId,jdbcType=VARCHAR} and orders.price_id=price.price_id and price.flight_id=flight.flight_id
	</select>
	<select id="getBysearch" resultMap="BaseResultMap">
	select
	<include refid="select_orders" />
		<include refid="select_flight"></include>
		from orders, price,flight 
        where user_id=#{user_id,jdbcType=VARCHAR} and orders.price_id=price.price_id and price.flight_id=flight.flight_id
        <if test="order_id!=null">
        AND order_id LIKE "%"#{order_id,jdbcType=VARCHAR}"%"
        </if>
        <if test="flight_ftime!=null">
        and flight_ftime like "%"#{flight_ftime,jdbcType=VARCHAR}"%"
        </if>
        <if test="order_time!=null">
        and order_time LIKE "%"#{order_time,jdbcType=VARCHAR}"%"
        </if>
	</select>
</mapper>